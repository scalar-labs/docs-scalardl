import CodeBlock from '@theme/CodeBlock';

<h3>ライセンスを設定する</h3>

ScalarDL Auditor を使用するには商用ライセンスが必要です。以下の手順でライセンスを設定してください。

1. <code>{props.shortName}/docker-compose-ledger.yml</code> ファイルで Enterprise エディションのコンテナイメージを有効にします:

   - イメージを変更する前 (デフォルト設定):

     ```yaml
     # docker-compose-ledger.yml
     services:
       scalardl-ledger:
         image: ghcr.io/scalar-labs/scalardl-ledger:${SCALARDL_VERSION}
         # image: ghcr.io/scalar-labs/scalardl-ledger-byol:${SCALARDL_VERSION}
     ```

   - イメージを変更した後:

     ```yaml
     # docker-compose-ledger.yml
     services:
       scalardl-ledger:
         # image: ghcr.io/scalar-labs/scalardl-ledger:${SCALARDL_VERSION}
         image: ghcr.io/scalar-labs/scalardl-ledger-byol:${SCALARDL_VERSION}
     ```

2. ScalarDL Ledger と Auditor のライセンスキーを設定します。<code>{props.shortName}/ledger.properties</code> と <code>{props.shortName}/auditor.properties</code> ファイルで、`<SET_YOUR_LICENSE_KEY>` をライセンスキーに置き換えます。例:

   ```properties
   ##### PLEASE REPLACE THIS VALUE WITH YOUR LICENSE KEY (ENTERPRISE EDITION ONLY) #####
   scalar.dl.licensing.license_key={"organization_name":"XXXXXXXX","expiration_date_time":"YYYY-MM-DDTHH:mm:SS+TIMEZONE","product_name":"ScalarDL Ledger","product_version":N,"license_type":"trial","signature":"XXXXXXXX"}
   ##### PLEASE REPLACE THIS VALUE WITH YOUR LICENSE KEY (ENTERPRISE EDITION ONLY) #####
   ```

3. 証明書を利用してライセンスを検証するには、<code>{props.shortName}/docker-compose-ledger.yml</code> と <code>{props.shortName}/docker-compose-auditor.yml</code> ファイルを以下のように更新します。試用ライセンスを使用している場合は、このステップをスキップしてください。

   - 証明書ファイルパスを変更する前 (デフォルト設定):

     ```yaml
     # docker-compose-ledger.yml
     services:
       scalardl-ledger:
         volumes:
           - ./ledger.properties:/scalar/ledger/ledger.properties.tmpl
           - ../fixture/ledger-key.pem:/scalar/ledger-key.pem
           - ../fixture/trial-license-cert.pem:/scalar/license-cert.pem
           # If you have a commercial license key, you must use `commercial-license-cert.pem` instead of `trial-license-cert.pem`.
           # - ../fixture/commercial-license-cert.pem:/scalar/license-cert.pem
     ```

     ```yaml
     # docker-compose-auditor.yml
     services:
       scalardl-auditor:
         volumes:
           - ./auditor.properties:/scalar/auditor/auditor.properties.tmpl
           - ../fixture/auditor-key.pem:/scalar/auditor-key.pem
           - ../fixture/trial-license-cert.pem:/scalar/license-cert.pem
           # If you have a commercial license key, you must use `commercial-license-cert.pem` instead of `trial-license-cert.pem`.
           # - ../fixture/commercial-license-cert.pem:/scalar/license-cert.pem
     ```

   - 証明書ファイルパスを変更した後:

     ```yaml
     # docker-compose-ledger.yml
     services:
       scalardl-ledger:
         volumes:
           - ./ledger.properties:/scalar/ledger/ledger.properties.tmpl
           - ../fixture/ledger-key.pem:/scalar/ledger-key.pem
           # - ../fixture/trial-license-cert.pem:/scalar/license-cert.pem
           # If you have a commercial license key, you must use `commercial-license-cert.pem` instead of `trial-license-cert.pem`.
           - ../fixture/commercial-license-cert.pem:/scalar/license-cert.pem
     ```

     ```yaml
     # docker-compose-auditor.yml
     services:
       scalardl-auditor:
         volumes:
           - ./auditor.properties:/scalar/auditor/auditor.properties.tmpl
           - ../fixture/auditor-key.pem:/scalar/auditor-key.pem
           # - ../fixture/trial-license-cert.pem:/scalar/license-cert.pem
           # If you have a commercial license key, you must use `commercial-license-cert.pem` instead of `trial-license-cert.pem`.
           - ../fixture/commercial-license-cert.pem:/scalar/license-cert.pem
     ```

<h3>ScalarDL を起動する</h3>

以下の手順に従って ScalarDL Ledger と Auditor の使用を開始できます:

1. 以下のコマンドを実行して {props.productName} をローカルで実行します:

   <CodeBlock language="console">docker compose -f {props.shortName}/docker-compose-auditor.yml up -d {props.shortName}</CodeBlock>

2. 以下のコマンドを実行して ScalarDL Ledger と Auditor のデータベーススキーマを読み込みます:

   <CodeBlock language="console">docker compose -f {props.shortName}/docker-compose-auditor.yml up -d scalardl-ledger-schema-loader
   docker compose -f {props.shortName}/docker-compose-auditor.yml up -d scalardl-auditor-schema-loader</CodeBlock>

3. 以下のコマンドを実行して ScalarDL Ledger、Auditor、およびその依存コンポーネントを起動します:

   <CodeBlock language="console">docker compose -f {props.shortName}/docker-compose-auditor.yml up -d</CodeBlock>